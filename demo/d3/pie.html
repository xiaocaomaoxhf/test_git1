<!DOCTYPE HTML><html lang="en"><head>  <meta charset="UTF-8">  <title>Hello D3</title>  <script src="d3.js"></script>  <style>  </style></head><body><script>  var data = [];  function randomValue(){    return Math.floor(Math.random()*8+2);  }  function update(){    data.length = 0;    for(var i = 0; i < 3; i++){      data.push({id:i,value:randomValue()});    }    chart.render();  }  function pieChart(){    var _chart = {};    var _width = 500;    var _height = 500;    var _svg;    var _bodyG;    var _pieG;    var _colors = d3.scale.category10();    var _radius = 200;    var _innerRadius = 100;    _chart.render = function(){      if(!_svg){        _svg = d3.select('body').append('svg')            .attr('width',_width)            .attr('height',_height)      }      renderBody();    }    function renderBody(){      if(!_bodyG){        _bodyG = _svg.append('g')            .classed('body',true)      }      renderPie();    }    function renderPie(){      if(!_pieG){        _pieG = _bodyG.append('g')            .classed('pie',true)            .attr('transform','translate('+ _radius +','+ _radius +')')      }      var pie = d3.layout.pie()          .sort(function(d){            return d.id;          })          .value(function(d){            return d.value;          });      var arc = d3.svg.arc()          .outerRadius(_radius)          .innerRadius(_innerRadius)      renderSlices(pie,arc);      renderLabels(pie,arc);    }    function renderSlices(pie,arc){      var slices = _pieG.selectAll('path.arc').data(pie(data));      slices          .enter()          .append('path')          .classed('arc',true)          .attr('fill',function(d,i){            return _colors(i);          })      slices          .transition()          .duration(500)          .attrTween('d',function(d,i){            var currentArc = this.__current__;            if(!currentArc){              currentArc = {                startAngle:0,                endAngle:0              }            }            var interpolate = d3.interpolate(currentArc,d);            this.__current__ = interpolate(1);            return function(t){              return arc(interpolate(t));            }          })    }    function renderLabels(pie,arc){      var labels = _pieG.selectAll('text.label').data(pie(data));      labels          .enter()          .append('text')          .classed('label',true)      labels          .transition()          .attr('transform',function(d,i){            return 'translate('+ arc.centroid(d) +')'          })          .attr('dy','0.35em')          .attr('text-anchor','middle')          .text(function(d){            return d.data.value;          })    }    return _chart;  }  var chart = pieChart();  update();</script><button onclick="update()">Update</button></body>