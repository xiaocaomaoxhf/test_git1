<!DOCTYPE HTML><html lang="en"><head>  <meta charset="UTF-8">  <title>Hello D3</title>  <script src="d3.js"></script>  <style>    .axis path,    .axis line{      fill: none;      stroke: black;      shape-rendering: crispEdges;    }    .axis text {      font-family: sans-serif;      font-size: 11px;    }  </style></head><body><script>  //1. 确定初始数据  var dataset = [    {      name: "PC" ,      sales: [        { year:2005, profit: 3000 },        { year:2006, profit: 1300 },        { year:2007, profit: 3700 },        { year:2008, profit: 4900 },        { year:2009, profit: 700 }      ]    },    {      name: "SmartPhone" ,      sales: [        { year:2005, profit: 2000 },        { year:2006, profit: 4000 },        { year:2007, profit: 1810 },        { year:2008, profit: 6540 },        { year:2009, profit: 2820 }      ]    },    {      name: "Software" ,      sales: [        { year:2005, profit: 1100 },        { year:2006, profit: 1700 },        { year:2007, profit: 1680 },        { year:2008, profit: 4000 },        { year:2009, profit: 4900 }      ]    }  ];  var stack = d3.layout.stack()      .values(function(d){        return d.sales;      })      .x(function (d) {        return d.year;      })      .y(function (d) {        return d.profit;      });  var data = stack(dataset);  var width = 700;  var height = 500;  var padding = {    top: 50,    right: 100,    bottom: 50,    left: 50  };  var svg = d3.select('body')      .append('svg')      .attr('width',width)      .attr('height',height);  var charts = svg.append('g')      .attr('transform','translate('+ padding.left +','+ padding.top +')');  var maxProfit = d3.max(data[data.length-1].sales,function(d){    return d.y0+ d.y;  });  var xScale = d3.scale.ordinal().domain([2005,2006,2007,2008,2009]).rangeBands([0,width-padding.left-padding.right],0.3);  var yScale = d3.scale.linear().domain([0,maxProfit]).range([0,height-padding.top-padding.bottom]);  var colors = d3.scale.category10();  var stack = charts.selectAll('.stakc')      .data(data)      .enter()      .append('g')      .classed('stack',true)      .attr('fill',function(d,i){        return colors(i);      })  var rect = stack.selectAll('rect')      .data(function(d){        return d.sales;      })      .enter()      .append('rect')      .attr('x', function (d) {        return xScale(d.year);      })      .attr('y', function (d) {        return height-padding.top-padding.bottom-yScale(d.y0+d.y);      })      .attr('width',xScale.rangeBand())      .attr('height', function (d) {        return yScale(d.y);      })  var xAxis = d3.svg.axis().scale(xScale);  var yAxis = d3.svg.axis().scale(yScale.range([height-padding.top-padding.bottom,0])).orient('left');  charts.append('g')      .classed('x axis',true)      .attr('transform','translate(0,'+ (height-padding.top-padding.bottom) +')')      .call(xAxis)  charts.append('g')      .classed('y axis',true)      .call(yAxis)  stack.append('circle')      .attr('cx', function (d) {        return width-padding.left-padding.right*0.9      })      .attr('cy', function (d,i) {        return i*50      })      .attr('r', 5)  stack.append('text')      .attr('x', function (d) {        return width-padding.left-padding.right*0.8      })      .attr('y', function (d,i) {        return i*50      })      .attr('dy', 5)      .text(function (d) {        return d.name;      })</script></body>